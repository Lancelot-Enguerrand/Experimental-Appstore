{
  "schemaVersion": 2,
  "$schema": "https://schemas.runtipi.io/v2/dynamic-compose.json",
  "services": [
    {
      "name": "medical-records",
      "image": "ghcr.io/afairgiant/medikeep:v0.54.0",
      "isMain": true,
      "internalPort": 8000,
      "environment": [
          { "key": "PUID", "value": "${MEDRECORDS_PUID-1000}" },
          { "key": "PGID", "value": "${MEDRECORDS_PGID-1000}" },
          { "key": "DB_HOST", "value": "medical-records-db" },
          { "key": "DB_PORT", "value": 5432 },
          { "key": "DB_NAME", "value": "medrecords" },
          { "key": "DB_USER", "value": "medapp" },
          { "key": "DB_PASSWORD", "value": "${MEDRECORDS_DB_PASSWORD}" },
          { "key": "SECRET_KEY", "value": "${MEDRECORDS_SECRET_KEY}" },
          { "key": "TZ", "value": "${TZ}" },
          { "key": "LOG_LEVEL", "value": "INFO" }
      ],
      "volumes": [
        {
          "hostPath": "${APP_DATA_DIR}/data/uploads",
          "containerPath": "/app/uploads"
        },
        {
          "hostPath": "${APP_DATA_DIR}/data/logs",
          "containerPath": "/app/logs"
        },
        {
          "hostPath": "${APP_DATA_DIR}/data/backups",
          "containerPath": "/app/backups"
        }
      ]
    },
    {
      "name": "medical-records-db",
      "image": "postgres:15.8-alpine",
      "environment": [
          { "key": "POSTGRES_DB", "value": "medrecords" },
          { "key": "POSTGRES_USER", "value": "medapp" },
          { "key": "POSTGRES_PASSWORD", "value": "${MEDRECORDS_DB_PASSWORD}" }
      ],
      "volumes": [
        {
          "hostPath": "${APP_DATA_DIR}/data/db",
          "containerPath": "/var/lib/postgresql/data"
        }
      ]
    }
  ]
}