{
  "schemaVersion": 2,
  "$schema": "https://schemas.runtipi.io/v2/dynamic-compose.json",
  "services": [
    {
      "name": "monica-5",
      "image": "ghcr.io/monicahq/monica-next:main",
      "isMain": true,
      "internalPort": 80,
      "environment": [
          { "key": "APP_KEY", "value": "${MONICA_APP_KEY}" },
          { "key": "APP_DISABLE_SIGNUP", "value": "${MONICA_DISABLE_SIGNUP}" },
          { "key": "APP_URL", "value": "${APP_PROTOCOL-http}://${APP_DOMAIN}" },
          { "key": "DB_CONNECTION", "value": "mysql" },
          { "key": "DB_HOST", "value": "monica-5-db" },
          { "key": "DB_USERNAME", "value": "usermonica" },
          { "key": "DB_PASSWORD", "value": "${MONICA_DB_PASS}" },
          { "key": "UPLOADCARE_PUBLIC_KEY", "value": "${MONICA_UPLOADCARE_PUBLIC_KEY}" },
          { "key": "UPLOADCARE_PRIVATE_KEY", "value": "${MONICA_UPLOADCARE_PRIVATE_KEY}" }
      ],
      "dependsOn": ["monica-5-db"],
      "volumes": [
        {
          "hostPath": "${APP_DATA_DIR}/data",
          "containerPath": "/var/www/html/storage"
        }
      ]
    },
    {
      "name": "monica-5-db",
      "image": "mariadb:11",
      "environment": [
          { "key": "TZ", "value": "${TZ}" },
          { "key": "MARIADB_RANDOM_ROOT_PASSWORD", "value": "true" },
          { "key": "MARIADB_DATABASE", "value": "monica" },
          { "key": "MARIADB_USER", "value": "usermonica" },
          { "key": "MARIADB_PASSWORD", "value": "${MONICA_DB_PASS}" }
      ],
      "volumes": [
        {
          "hostPath": "${APP_DATA_DIR}/mysql",
          "containerPath": "/var/lib/mysql"
        }
      ]
    }
  ]
}
